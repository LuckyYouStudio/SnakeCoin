<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ ËõáÂ∏ÅNFTÁúüÂÆûÊäΩÂ•ñ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            color: #333;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            color: #666;
        }

        .wallet-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .wallet-section h2 {
            color: #333;
            margin-bottom: 15px;
        }

                 .wallet-buttons {
             display: flex;
             gap: 15px;
             justify-content: center;
             flex-wrap: wrap;
             margin-bottom: 20px;
         }
         
         .wallet-btn {
             background: #007bff;
             color: white;
             border: none;
             padding: 15px 25px;
             border-radius: 10px;
             font-size: 1.1rem;
             cursor: pointer;
             transition: all 0.3s ease;
             min-width: 200px;
             font-weight: bold;
         }
         
         .wallet-btn:hover {
             transform: translateY(-3px);
             box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
         }
         
         .wallet-btn:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             transform: none;
             box-shadow: none;
         }
         
         .luckyou-btn {
             background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
         }
         
         .luckyou-btn:hover:not(:disabled) {
             background: linear-gradient(45deg, #FF5252, #FF7676);
         }
         
         .metamask-btn {
             background: linear-gradient(45deg, #F6851B, #FFA726);
         }
         
         .metamask-btn:hover:not(:disabled) {
             background: linear-gradient(45deg, #F57C00, #FF9800);
         }
         
         .connect-btn {
             background: #007bff;
             color: white;
             border: none;
             padding: 12px 24px;
             border-radius: 8px;
             font-size: 1.1rem;
             cursor: pointer;
             transition: all 0.3s ease;
         }
 
         .connect-btn:hover {
             background: #0056b3;
             transform: translateY(-2px);
         }
 
         .connect-btn:disabled {
             background: #6c757d;
             cursor: not-allowed;
             transform: none;
         }

        .wallet-info {
            margin-top: 15px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .lottery-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .lottery-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .info-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .info-card p {
            font-size: 1.5rem;
            font-weight: bold;
            color: #007bff;
        }

        .lottery-btn {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            display: block;
        }

        .lottery-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .lottery-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .nft-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .nft-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .nft-card h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
        }

        .nft-svg {
            width: 100%;
            height: 200px;
            border: 1px solid #eee;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .nft-info {
            font-size: 0.9rem;
            color: #666;
        }

        .nft-info p {
            margin-bottom: 8px;
        }

        .status {
            text-align: center;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            font-weight: bold;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .contract-info {
            background: #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .contract-info h3 {
            margin-bottom: 10px;
            color: #333;
        }

        .contract-info p {
            margin-bottom: 5px;
            word-break: break-all;
        }

        /* Ê†áÁ≠æÈ°µÊ†∑Âºè */
        .tabs-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .tabs-header {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 30px;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-right: 10px;
        }

        .tab-btn:hover {
            color: #007bff;
            background: #f8f9fa;
        }

        .tab-btn.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: #f8f9fa;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .my-nft-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

                 .nft-status {
             font-size: 0.9rem;
             color: #666;
             font-style: italic;
         }
         
         /* Èí±ÂåÖÂàáÊç¢Ê†∑Âºè */
         .wallet-switch {
             margin-top: 15px;
             padding: 15px;
             background: #f8f9fa;
             border-radius: 8px;
             text-align: center;
         }
         
         .switch-btn {
             background: #6c757d;
             color: white;
             border: none;
             padding: 8px 16px;
             border-radius: 6px;
             font-size: 0.9rem;
             cursor: pointer;
             transition: all 0.3s ease;
             margin-right: 10px;
         }
         
         .switch-btn:hover {
             background: #5a6268;
             transform: translateY(-1px);
         }
         
         .switch-info {
             font-size: 0.9rem;
             color: #666;
             font-style: italic;
         }

        .network-status {
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }

        .network-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .network-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .network-status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé≤ ËõáÂ∏ÅNFTÁúüÂÆûÊäΩÂ•ñ</h1>
            <p>ËøûÊé• LuckYou Èí±ÂåÖÊàñ MetaMaskÔºåÊîØ‰ªò0.0001 ETHÂèÇ‰∏éÁúüÂÆûÊäΩÂ•ñÔºÅ</p>
        </div>

                 <div class="wallet-section">
             <h2>üîó Èí±ÂåÖËøûÊé•</h2>
             <div class="wallet-buttons">
                 <button id="luckyouBtn" class="wallet-btn luckyou-btn" onclick="connectLuckYou()">
                     üçÄ ËøûÊé• LuckYou Èí±ÂåÖ
                 </button>
                 <button id="metamaskBtn" class="wallet-btn metamask-btn" onclick="connectMetaMask()">
                     ü¶ä ËøûÊé• MetaMask
                 </button>
             </div>
             <div id="walletSwitch" class="wallet-switch" style="display: none;">
                 <button id="switchWalletBtn" class="switch-btn" onclick="switchWallet()">
                     üîÑ ÂàáÊç¢Èí±ÂåÖ
                 </button>
                 <span class="switch-info">ÂΩìÂâç‰ΩøÁî®: <span id="currentWalletName">-</span></span>
             </div>
             <div id="walletInfo" class="wallet-info" style="display: none;">
                 <!-- Èí±ÂåÖ‰ø°ÊÅØÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
             </div>
         </div>

        <div class="lottery-section">
            <h2>üéØ ÊäΩÂ•ñ‰ø°ÊÅØ</h2>
            
            <div class="contract-info">
                <h3>üìã ÂêàÁ∫¶‰ø°ÊÅØ</h3>
                <p><strong>ÂêàÁ∫¶Âú∞ÂùÄ:</strong> <span id="contractAddress">Êú™ËøûÊé•</span></p>
                <p><strong>ÁΩëÁªú:</strong> <span id="networkInfo">Êú™ËøûÊé•</span></p>
                <div id="networkStatus" class="network-status" style="display: none;">
                    <p><strong>ÁΩëÁªúÁä∂ÊÄÅ:</strong> <span id="networkStatusText">-</span></p>
                    <p id="networkSwitchTip" style="color: #ff6b6b; font-size: 14px; margin: 5px 0;"></p>
                </div>
            </div>

                         <div class="lottery-info">
                 <div class="info-card">
                     <h3>ÊäΩÂ•ñ‰ª∑Ê†º</h3>
                     <p id="lotteryPrice">0.0001 ETH</p>
                 </div>
                 <div class="info-card">
                     <h3>Ê±†Â≠êÂ§ßÂ∞è</h3>
                     <p id="poolSize">-</p>
                 </div>
                 <div class="info-card">
                     <h3>Â∑≤Èì∏ÈÄ†</h3>
                     <p id="totalMinted">-</p>
                 </div>
                 <div class="info-card">
                     <h3>Ââ©‰ΩôÊï∞Èáè</h3>
                     <p id="remainingSupply">-</p>
                 </div>
             </div>
             
             <div style="text-align: center; margin-bottom: 20px;">
                 <button id="refreshInfoBtn" class="connect-btn" onclick="refreshContractInfo()" style="margin: 0 10px;">
                     üîÑ Âà∑Êñ∞ÂêàÁ∫¶‰ø°ÊÅØ
                 </button>
                 <button id="preloadInfoBtn" class="connect-btn" onclick="preloadContractInfo()" style="margin: 0 10px;">
                     üì° ÈáçÊñ∞Âä†ËΩΩ
                 </button>
                 <button id="diagnoseBtn" class="connect-btn" onclick="diagnoseNetwork()" style="margin: 0 10px; background: #17a2b8;">
                     üîç ÁΩëÁªúËØäÊñ≠
                 </button>
             </div>

            <button id="lotteryBtn" class="lottery-btn" onclick="playLottery()" disabled>
                ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ
            </button>

            <div id="statusDiv"></div>
        </div>

        <div class="tabs-section">
            <div class="tabs-header">
                <button class="tab-btn active" onclick="switchTab('latest')" id="latestTab">
                    üéâ ÊúÄÊñ∞ÊäΩ‰∏≠ÁöÑNFT
                </button>
                <button class="tab-btn" onclick="switchTab('my')" id="myTab">
                    üñºÔ∏è ÊàëÁöÑNFT
                </button>
            </div>
            
            <div class="tab-content active" id="latestTabContent">
                <div class="nft-grid" id="nftGrid">
                    <!-- ÊäΩ‰∏≠ÁöÑNFTÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                </div>
            </div>
            
            <div class="tab-content" id="myTabContent">
                <div class="my-nft-controls">
                    <button id="refreshNftBtn" class="connect-btn" onclick="loadUserNFTs()">
                        üîÑ Âà∑Êñ∞ÊàëÁöÑNFT
                    </button>
                    <div id="myNftStatus" class="nft-status"></div>
                </div>
                <div class="nft-grid" id="myNftGrid">
                    <!-- Áî®Êà∑Êã•ÊúâÁöÑNFTÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÂêàÁ∫¶ÈÖçÁΩÆ
        const CONTRACT_ADDRESS = "0xa513E6E4b8f2a923D98304ec87F64353C4D5C853";
        const CONTRACT_ABI = [
            {
                "constant": true,
                "inputs": [],
                "name": "lotteryPrice",
                "outputs": [{"name": "", "type": "uint256"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "getPoolSize",
                "outputs": [{"name": "", "type": "uint256"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "totalSupply",
                "outputs": [{"name": "", "type": "uint256"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },

            {
                "constant": false,
                "inputs": [],
                "name": "playLottery",
                "outputs": [],
                "payable": true,
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [{"name": "tokenId", "type": "uint256"}],
                "name": "generateSnakeSVG",
                "outputs": [{"name": "", "type": "string"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [{"name": "tokenId", "type": "uint256"}],
                "name": "ownerOf",
                "outputs": [{"name": "", "type": "address"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [{"name": "tokenId", "type": "uint256"}],
                "name": "tokenURI",
                "outputs": [{"name": "", "type": "string"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "getLotteryInfo",
                "outputs": [
                    {"name": "price", "type": "uint256"},
                    {"name": "poolSize", "type": "uint256"},
                    {"name": "totalMinted", "type": "uint256"},
                    {"name": "remaining", "type": "uint256"}
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "anonymous": false,
                "inputs": [
                    {"indexed": true, "name": "winner", "type": "address"},
                    {"indexed": true, "name": "tokenId", "type": "uint256"},
                    {"indexed": false, "name": "price", "type": "uint256"}
                ],
                "name": "LotteryWon",
                "type": "event"
            }
        ];

                 let web3;
         let contract;
         let userAccount;
         let userBalance;
         let currentWalletProvider;
         let currentWalletName;

        // È¢úËâ≤ÂíåË∑ØÂæÑÈÖçÁΩÆ
        const colors = [
            "#FF6B6B", "#4ECDC4", "#45B7D1", "#96CEB4", "#FFEAA7",
            "#DDA0DD", "#FFB347", "#87CEEB", "#98FB98", "#F0E68C"
        ];

        const snakePaths = [
            "M10,10 Q20,5 30,10 T50,10",
            "M10,10 C20,5 30,15 50,10",
            "M10,10 L30,5 L50,10",
            "M10,10 Q30,5 50,10",
            "M10,10 Q25,5 40,10 Q55,15 70,10",
            "M10,10 C15,5 25,15 35,10 C45,5 55,15 65,10",
            "M10,10 L20,5 L30,10 L40,5 L50,10",
            "M10,10 Q20,5 30,10 Q40,15 50,10",
            "M10,10 C20,5 30,15 40,10 C50,5 60,15 70,10",
            "M10,10 Q15,5 20,10 Q25,15 30,10 Q35,5 40,10 Q45,15 50,10"
        ];

                 // Êñ≠ÂºÄËøûÊé•
         function disconnectWallet() {
             const luckyouBtn = document.getElementById('luckyouBtn');
             const metamaskBtn = document.getElementById('metamaskBtn');
             const walletInfo = document.getElementById('walletInfo');
             const lotteryBtn = document.getElementById('lotteryBtn');
             
             // ÈáçÁΩÆÁä∂ÊÄÅ
             userAccount = null;
             userBalance = null;
             web3 = null;
             contract = null;
             currentWalletProvider = null;
             currentWalletName = null;
             
             // Êõ¥Êñ∞UI
             walletInfo.style.display = 'none';
             lotteryBtn.disabled = true;
             lotteryBtn.innerHTML = 'ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ';
             
             // ÈáçÁΩÆÊåâÈíÆÁä∂ÊÄÅ
             luckyouBtn.disabled = false;
             metamaskBtn.disabled = false;
             luckyouBtn.innerHTML = 'üçÄ ËøûÊé• LuckYou Èí±ÂåÖ';
             metamaskBtn.innerHTML = 'ü¶ä ËøûÊé• MetaMask';
             luckyouBtn.style.background = 'linear-gradient(45deg, #FF6B6B, #FF8E8E)';
             metamaskBtn.style.background = 'linear-gradient(45deg, #F6851B, #FFA726)';
             luckyouBtn.onclick = connectLuckYou;
             metamaskBtn.onclick = connectMetaMask;
             
             // ÈöêËóèÈí±ÂåÖÂàáÊç¢ÈÄâÈ°π
             document.getElementById('walletSwitch').style.display = 'none';
             
             // ÈöêËóèÁΩëÁªúÁä∂ÊÄÅÊòæÁ§∫
             updateNetworkStatus(null, null, false);
             
             showStatus('üîå Èí±ÂåÖÂ∑≤Êñ≠ÂºÄËøûÊé•', 'info');
         }

                         // ËøûÊé• LuckYou Èí±ÂåÖ
         async function connectLuckYou() {
             const luckyouBtn = document.getElementById('luckyouBtn');
             const metamaskBtn = document.getElementById('metamaskBtn');
             const walletInfo = document.getElementById('walletInfo');
             
             try {
                 // Á¶ÅÁî®‰∏§‰∏™ÊåâÈíÆ
                 luckyouBtn.disabled = true;
                 metamaskBtn.disabled = true;
                 luckyouBtn.innerHTML = '<span class="spinner"></span> ËøûÊé•‰∏≠...';
                 
                 let walletProvider;
                 let walletName = 'LuckYou Wallet';
                 
                 // Ê£ÄÊµã LuckYou Èí±ÂåÖ
                 if (typeof window.luckYou !== 'undefined') {
                     walletProvider = window.luckYou;
                     console.log('‰ΩøÁî®‰∏ªË¶Å LuckYou Èí±ÂåÖÂØπË±°');
                 } else if (window.luckyouWallet && window.luckyouWallet.isLuckYouWallet) {
                     walletProvider = window.luckyouWallet;
                     console.log('‰ΩøÁî®Êõø‰ª£ LuckYou Èí±ÂåÖÂØπË±°');
                 } else {
                     throw new Error('Êú™Ê£ÄÊµãÂà∞ LuckYou Èí±ÂåÖÔºåËØ∑ÂÆâË£Ö LuckYou Èí±ÂåÖÊâ©Â±ïÔºÅ');
                 }
                 
                 // ‰øùÂ≠òÂΩìÂâçÈí±ÂåÖ‰ø°ÊÅØ
                 currentWalletProvider = walletProvider;
                 currentWalletName = walletName;
                 
                 console.log('LuckYou Èí±ÂåÖÊèê‰æõËÄÖ:', walletProvider);
                 console.log('Èí±ÂåÖÊèê‰æõËÄÖÁ±ªÂûã:', typeof walletProvider);
                 console.log('Èí±ÂåÖÊèê‰æõËÄÖÊñπÊ≥ï:', Object.getOwnPropertyNames(walletProvider));
                 
                 // ËØ∑Ê±ÇË¥¶Êà∑ËøûÊé•
                 const accounts = await walletProvider.request({
                     method: 'eth_requestAccounts'
                 });
 
                 userAccount = accounts[0];
                 console.log('LuckYou Èí±ÂåÖË¥¶Êà∑Âú∞ÂùÄ:', userAccount);
                 
                 // Ê£ÄÊü•ÁΩëÁªú
                 let chainId;
                 let networkName;
                 try {
                     chainId = await walletProvider.request({ method: 'eth_chainId' });
                     networkName = getNetworkName(chainId);
                     console.log('LuckYou Èí±ÂåÖÁΩëÁªú Chain ID:', chainId);
                     console.log('LuckYou Èí±ÂåÖÁΩëÁªúÂêçÁß∞:', networkName);
                     
                     // Ê£ÄÊü•ÁΩëÁªúÊòØÂê¶ÂåπÈÖç
                     if (chainId !== '0x539' && chainId !== '0x31337' && chainId !== '0x7a69') {
                         showStatus('‚ö†Ô∏è ÂΩìÂâçÁΩëÁªú‰∏çÂåπÈÖçÔºåËØ∑ÂàáÊç¢Âà∞Êú¨Âú∞ Hardhat ÁΩëÁªú', 'warning');
                         console.warn('ÁΩëÁªú‰∏çÂåπÈÖçÔºåÂêàÁ∫¶Âú∞ÂùÄ‰ªÖÈÄÇÁî®‰∫éÊú¨Âú∞ Hardhat ÁΩëÁªú');
                         
                         // Â∞ùËØïÂàáÊç¢Âà∞Ê≠£Á°ÆÁöÑÁΩëÁªú
                         try {
                             await walletProvider.request({
                                 method: 'wallet_switchEthereumChain',
                                 params: [{ chainId: '0x7a69' }]
                             });
                             console.log('Â∑≤ÂàáÊç¢Âà∞ Hardhat ÁΩëÁªú');
                             chainId = '0x7a69';
                             networkName = 'Hardhat Local Network';
                         } catch (switchError) {
                             console.warn('ÁΩëÁªúÂàáÊç¢Â§±Ë¥•:', switchError);
                             showStatus('‚ùå ËØ∑ÊâãÂä®ÂàáÊç¢Âà∞Êú¨Âú∞ Hardhat ÁΩëÁªú (Chain ID: 31337 Êàñ 1337)', 'error');
                             
                             // ÈáçÁΩÆÊåâÈíÆÁä∂ÊÄÅ
                             luckyouBtn.disabled = false;
                             metamaskBtn.disabled = false;
                             metamaskBtn.innerHTML = 'ËøûÊé• MetaMask';
                             return;
                         }
                     }
                 } catch (networkError) {
                     console.error('Ëé∑ÂèñÁΩëÁªú‰ø°ÊÅØÂ§±Ë¥•:', networkError);
                     chainId = '0x539';
                     networkName = 'Hardhat Local Network';
                 }
                 
                 // ÂàùÂßãÂåñWeb3ÂíåÂêàÁ∫¶
                 try {
                     web3 = new Web3(walletProvider);
                     console.log('Web3 ÂàùÂßãÂåñÊàêÂäü');
                     
                     contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                     console.log('ÂêàÁ∫¶ÂÆû‰æãÂàõÂª∫ÊàêÂäüÔºåÂú∞ÂùÄ:', CONTRACT_ADDRESS);
                     
                     // È™åËØÅÂêàÁ∫¶ÊòØÂê¶Â∑≤ÈÉ®ÁΩ≤
                     try {
                         const code = await web3.eth.getCode(CONTRACT_ADDRESS);
                         console.log('ÂêàÁ∫¶‰ª£Á†ÅÈïøÂ∫¶:', code.length);
                         if (code === '0x' || code === '0x0') {
                             throw new Error('ÂêàÁ∫¶Âú∞ÂùÄ‰∏äÊ≤°Êúâ‰ª£Á†ÅÔºåËØ∑Ê£ÄÊü•ÂêàÁ∫¶ÊòØÂê¶Â∑≤ÈÉ®ÁΩ≤');
                         }
                         console.log('ÂêàÁ∫¶‰ª£Á†ÅÈ™åËØÅÊàêÂäü');
                     } catch (codeError) {
                         console.error('ÂêàÁ∫¶‰ª£Á†ÅÈ™åËØÅÂ§±Ë¥•:', codeError);
                         throw new Error('ÂêàÁ∫¶Êú™ÈÉ®ÁΩ≤ÊàñÂú∞ÂùÄÈîôËØØ');
                     }
                     
                     // ÊµãËØïÂêàÁ∫¶Ë∞ÉÁî®
                     try {
                         console.log('ÊµãËØï LuckYou Èí±ÂåÖÂêàÁ∫¶Ë∞ÉÁî®...');
                         const testPrice = await contract.methods.lotteryPrice().call();
                         console.log('LuckYou Èí±ÂåÖÊµãËØïË∞ÉÁî®ÊàêÂäüÔºåÊäΩÂ•ñ‰ª∑Ê†º:', testPrice);
                     } catch (testError) {
                         console.error('LuckYou Èí±ÂåÖÊµãËØïË∞ÉÁî®Â§±Ë¥•:', testError);
                         console.warn('ËøôÂèØËÉΩÊòØÁΩëÁªúÊàñÊùÉÈôêÈóÆÈ¢ò');
                     }
                     
                     // Ëé∑ÂèñÁî®Êà∑‰ΩôÈ¢ù
                     try {
                         // Áõ¥Êé•‰ΩøÁî®Èí±ÂåÖÊèê‰æõËÄÖËé∑Âèñ‰ΩôÈ¢ùÔºåÈÅøÂÖç Web3.js ÁöÑËá™Âä®ËΩ¨Êç¢
                         const balanceResult = await walletProvider.request({
                             method: 'eth_getBalance',
                             params: [userAccount, 'latest']
                         });
                         
                         console.log('ÂéüÂßã‰ΩôÈ¢ùÁªìÊûú:', balanceResult, 'Á±ªÂûã:', typeof balanceResult);
                         
                         // Ê£ÄÊü•ËøîÂõûÁªìÊûúÊòØÂê¶‰∏∫ÊúâÊïàÊï∞Â≠ó
                         if (balanceResult && typeof balanceResult === 'string') {
                             if (balanceResult.match(/^0x[0-9a-fA-F]+$/)) {
                                 // ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè
                                 userBalance = balanceResult;
                                 console.log('Áî®Êà∑‰ΩôÈ¢ù(ÂçÅÂÖ≠ËøõÂà∂):', userBalance);
                             } else if (balanceResult.match(/^\d+$/)) {
                                 // ÂçÅËøõÂà∂Ê†ºÂºèÔºåËΩ¨Êç¢‰∏∫ÂçÅÂÖ≠ËøõÂà∂
                                 userBalance = '0x' + BigInt(balanceResult).toString(16);
                                 console.log('Áî®Êà∑‰ΩôÈ¢ù(ÂçÅËøõÂà∂ËΩ¨ÂçÅÂÖ≠ËøõÂà∂):', userBalance);
                             } else {
                                 console.warn('‰ΩôÈ¢ùËøîÂõûÊ†ºÂºèÂºÇÂ∏∏:', balanceResult);
                                 userBalance = '0';
                             }
                         } else if (balanceResult && typeof balanceResult === 'object' && balanceResult.error) {
                             // Â§ÑÁêÜÈîôËØØÂØπË±°
                             console.warn('‰ΩôÈ¢ùËøîÂõûÈîôËØØÂØπË±°:', balanceResult.error);
                             console.warn('RPC Ë∞ÉÁî®Â§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§‰ΩôÈ¢ù 0');
                             userBalance = '0';
                         } else {
                             console.warn('‰ΩôÈ¢ùËøîÂõûÁ±ªÂûãÂºÇÂ∏∏:', typeof balanceResult, balanceResult);
                             userBalance = '0';
                         }
                     } catch (balanceError) {
                         console.error('Ëé∑Âèñ‰ΩôÈ¢ùÂ§±Ë¥•:', balanceError);
                         console.warn('‰ΩøÁî®ÈªòËÆ§‰ΩôÈ¢ù 0');
                         userBalance = '0';
                     }
                 } catch (web3Error) {
                     console.error('Web3ÂàùÂßãÂåñÂ§±Ë¥•:', web3Error);
                     throw new Error('Web3ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•');
                 }
                 
                 // Êõ¥Êñ∞UI
                 updateWalletInfo(userAccount, userBalance, networkName, walletName);
                 updateLotteryInfo();
                 enableLottery();
                 
                 // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
                 luckyouBtn.innerHTML = 'Êñ≠ÂºÄËøûÊé•';
                 luckyouBtn.style.background = '#28a745';
                 luckyouBtn.onclick = disconnectWallet;
                 
                 // ÊòæÁ§∫Èí±ÂåÖÂàáÊç¢ÈÄâÈ°π
                 document.getElementById('walletSwitch').style.display = 'block';
                 document.getElementById('currentWalletName').textContent = walletName;
                 
                 showStatus(`‚úÖ ${walletName} Èí±ÂåÖËøûÊé•ÊàêÂäüÔºÅ`, 'success');
                 
             } catch (error) {
                 console.error('LuckYou ËøûÊé•Â§±Ë¥•:', error);
                 showStatus(`‚ùå LuckYou ËøûÊé•Â§±Ë¥•: ${error.message}`, 'error');
                 
                 // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                 luckyouBtn.disabled = false;
                 metamaskBtn.disabled = false;
                 luckyouBtn.innerHTML = 'üçÄ ËøûÊé• LuckYou Èí±ÂåÖ';
                 luckyouBtn.style.background = 'linear-gradient(45deg, #FF6B6B, #FF8E8E)';
                 luckyouBtn.onclick = connectLuckYou;
             }
         }
         
         // ËøûÊé• MetaMask Èí±ÂåÖ
         async function connectMetaMask() {
             const luckyouBtn = document.getElementById('luckyouBtn');
             const metamaskBtn = document.getElementById('metamaskBtn');
             const walletInfo = document.getElementById('walletInfo');
             
             try {
                 // Á¶ÅÁî®‰∏§‰∏™ÊåâÈíÆ
                 luckyouBtn.disabled = true;
                 metamaskBtn.disabled = true;
                 metamaskBtn.innerHTML = '<span class="spinner"></span> ËøûÊé•‰∏≠...';
                 
                 let walletProvider;
                 let walletName = 'MetaMask';
                 
                 // Ê£ÄÊµã MetaMask
                 if (typeof window.ethereum !== 'undefined' && window.ethereum.isMetaMask) {
                     walletProvider = window.ethereum;
                     console.log('‰ΩøÁî® MetaMask Èí±ÂåÖ');
                 } else {
                     throw new Error('Êú™Ê£ÄÊµãÂà∞ MetaMaskÔºåËØ∑ÂÆâË£Ö MetaMask Êâ©Â±ïÔºÅ');
                 }
                 
                 // ‰øùÂ≠òÂΩìÂâçÈí±ÂåÖ‰ø°ÊÅØ
                 currentWalletProvider = walletProvider;
                 currentWalletName = walletName;
                 
                 console.log('MetaMask Èí±ÂåÖÊèê‰æõËÄÖ:', walletProvider);
                 console.log('Èí±ÂåÖÊèê‰æõËÄÖÁ±ªÂûã:', typeof walletProvider);
                 console.log('Èí±ÂåÖÊèê‰æõËÄÖÊñπÊ≥ï:', Object.getOwnPropertyNames(walletProvider));
                 
                 // ËØ∑Ê±ÇË¥¶Êà∑ËøûÊé•
                 const accounts = await walletProvider.request({
                     method: 'eth_requestAccounts'
                 });
 
                 userAccount = accounts[0];
                 console.log('MetaMask Èí±ÂåÖË¥¶Êà∑Âú∞ÂùÄ:', userAccount);
                 
                 // Ê£ÄÊü•ÁΩëÁªú
                 let chainId;
                 let networkName;
                 try {
                     chainId = await walletProvider.request({ method: 'eth_chainId' });
                     networkName = getNetworkName(chainId);
                     console.log('MetaMask Èí±ÂåÖÁΩëÁªú Chain ID:', chainId);
                     console.log('MetaMask Èí±ÂåÖÁΩëÁªúÂêçÁß∞:', networkName);
                     
                     // Ê£ÄÊü•ÁΩëÁªúÊòØÂê¶ÂåπÈÖç
                     if (chainId !== '0x539' && chainId !== '0x31337' && chainId !== '0x7a69') {
                         showStatus('‚ö†Ô∏è ÂΩìÂâçÁΩëÁªú‰∏çÂåπÈÖçÔºåËØ∑ÂàáÊç¢Âà∞Êú¨Âú∞ Hardhat ÁΩëÁªú', 'warning');
                         console.warn('ÁΩëÁªú‰∏çÂåπÈÖçÔºåÂêàÁ∫¶Âú∞ÂùÄ‰ªÖÈÄÇÁî®‰∫éÊú¨Âú∞ Hardhat ÁΩëÁªú');
                         
                         // Â∞ùËØïÂàáÊç¢Âà∞Ê≠£Á°ÆÁöÑÁΩëÁªú
                         try {
                             await walletProvider.request({
                                 method: 'wallet_switchEthereumChain',
                                 params: [{ chainId: '0x7a69' }]
                             });
                             console.log('Â∑≤ÂàáÊç¢Âà∞ Hardhat ÁΩëÁªú');
                             chainId = '0x7a69';
                             networkName = 'Hardhat Local Network';
                         } catch (switchError) {
                             console.warn('ÁΩëÁªúÂàáÊç¢Â§±Ë¥•:', switchError);
                             showStatus('‚ùå ËØ∑ÊâãÂä®ÂàáÊç¢Âà∞Êú¨Âú∞ Hardhat ÁΩëÁªú (Chain ID: 31337 Êàñ 1337)', 'error');
                             
                             // ÈáçÁΩÆÊåâÈíÆÁä∂ÊÄÅ
                             luckyouBtn.disabled = false;
                             metamaskBtn.disabled = false;
                             metamaskBtn.innerHTML = 'ËøûÊé• MetaMask';
                             return;
                         }
                     }
                 } catch (networkError) {
                     console.error('Ëé∑ÂèñÁΩëÁªú‰ø°ÊÅØÂ§±Ë¥•:', networkError);
                     chainId = '0x539';
                     networkName = 'Hardhat Local Network';
                 }
                 
                 // ÂàùÂßãÂåñWeb3ÂíåÂêàÁ∫¶
                 try {
                     web3 = new Web3(walletProvider);
                     console.log('Web3 ÂàùÂßãÂåñÊàêÂäü');
                     
                     contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                     console.log('ÂêàÁ∫¶ÂÆû‰æãÂàõÂª∫ÊàêÂäüÔºåÂú∞ÂùÄ:', CONTRACT_ADDRESS);
                     
                     // È™åËØÅÂêàÁ∫¶ÊòØÂê¶Â∑≤ÈÉ®ÁΩ≤
                     try {
                         const code = await web3.eth.getCode(CONTRACT_ADDRESS);
                         console.log('ÂêàÁ∫¶‰ª£Á†ÅÈïøÂ∫¶:', code.length);
                         if (code === '0x' || code === '0x0') {
                             throw new Error('ÂêàÁ∫¶Âú∞ÂùÄ‰∏äÊ≤°Êúâ‰ª£Á†ÅÔºåËØ∑Ê£ÄÊü•ÂêàÁ∫¶ÊòØÂê¶Â∑≤ÈÉ®ÁΩ≤');
                         }
                         console.log('ÂêàÁ∫¶‰ª£Á†ÅÈ™åËØÅÊàêÂäü');
                     } catch (codeError) {
                         console.error('ÂêàÁ∫¶‰ª£Á†ÅÈ™åËØÅÂ§±Ë¥•:', codeError);
                         throw new Error('ÂêàÁ∫¶Êú™ÈÉ®ÁΩ≤ÊàñÂú∞ÂùÄÈîôËØØ');
                     }
                     
                     // ÊµãËØïÂêàÁ∫¶Ë∞ÉÁî®
                     try {
                         console.log('ÊµãËØï MetaMask Èí±ÂåÖÂêàÁ∫¶Ë∞ÉÁî®...');
                         const testPrice = await contract.methods.lotteryPrice().call();
                         console.log('MetaMask Èí±ÂåÖÊµãËØïË∞ÉÁî®ÊàêÂäüÔºåÊäΩÂ•ñ‰ª∑Ê†º:', testPrice);
                     } catch (testError) {
                         console.error('MetaMask Èí±ÂåÖÊµãËØïË∞ÉÁî®Â§±Ë¥•:', testError);
                         console.warn('ËøôÂèØËÉΩÊòØÁΩëÁªúÊàñÊùÉÈôêÈóÆÈ¢ò');
                     }
                     
                     // Ëé∑ÂèñÁî®Êà∑‰ΩôÈ¢ù
                     try {
                         // Áõ¥Êé•‰ΩøÁî®Èí±ÂåÖÊèê‰æõËÄÖËé∑Âèñ‰ΩôÈ¢ùÔºåÈÅøÂÖç Web3.js ÁöÑËá™Âä®ËΩ¨Êç¢
                         const balanceResult = await walletProvider.request({
                             method: 'eth_getBalance',
                             params: [userAccount, 'latest']
                         });
                         
                         console.log('ÂéüÂßã‰ΩôÈ¢ùÁªìÊûú:', balanceResult, 'Á±ªÂûã:', typeof balanceResult);
                         
                         // Ê£ÄÊü•ËøîÂõûÁªìÊûúÊòØÂê¶‰∏∫ÊúâÊïàÊï∞Â≠ó
                         if (balanceResult && typeof balanceResult === 'string') {
                             if (balanceResult.match(/^0x[0-9a-fA-F]+$/)) {
                                 // ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè
                                 userBalance = balanceResult;
                                 console.log('Áî®Êà∑‰ΩôÈ¢ù(ÂçÅÂÖ≠ËøõÂà∂):', userBalance);
                             } else if (balanceResult.match(/^\d+$/)) {
                                 // ÂçÅËøõÂà∂Ê†ºÂºèÔºåËΩ¨Êç¢‰∏∫ÂçÅÂÖ≠ËøõÂà∂
                                 userBalance = '0x' + BigInt(balanceResult).toString(16);
                                 console.log('Áî®Êà∑‰ΩôÈ¢ù(ÂçÅËøõÂà∂ËΩ¨ÂçÅÂÖ≠ËøõÂà∂):', userBalance);
                             } else {
                                 console.warn('‰ΩôÈ¢ùËøîÂõûÊ†ºÂºèÂºÇÂ∏∏:', balanceResult);
                                 userBalance = '0';
                             }
                         } else if (balanceResult && typeof balanceResult === 'object' && balanceResult.error) {
                             // Â§ÑÁêÜÈîôËØØÂØπË±°
                             console.warn('‰ΩôÈ¢ùËøîÂõûÈîôËØØÂØπË±°:', balanceResult.error);
                             console.warn('RPC Ë∞ÉÁî®Â§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§‰ΩôÈ¢ù 0');
                             userBalance = '0';
                         } else {
                             console.warn('‰ΩôÈ¢ùËøîÂõûÁ±ªÂûãÂºÇÂ∏∏:', typeof balanceResult, balanceResult);
                             userBalance = '0';
                         }
                     } catch (balanceError) {
                         console.error('Ëé∑Âèñ‰ΩôÈ¢ùÂ§±Ë¥•:', balanceError);
                         console.warn('‰ΩøÁî®ÈªòËÆ§‰ΩôÈ¢ù 0');
                         userBalance = '0';
                     }
                 } catch (web3Error) {
                     console.error('Web3ÂàùÂßãÂåñÂ§±Ë¥•:', web3Error);
                     throw new Error('Web3ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•');
                 }
                 
                 // Êõ¥Êñ∞UI
                 updateWalletInfo(userAccount, userBalance, networkName, walletName);
                 updateLotteryInfo();
                 enableLottery();
                 
                 // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
                 metamaskBtn.innerHTML = 'Êñ≠ÂºÄËøûÊé•';
                 metamaskBtn.style.background = '#28a745';
                 metamaskBtn.onclick = disconnectWallet;
                 
                 // ÊòæÁ§∫Èí±ÂåÖÂàáÊç¢ÈÄâÈ°π
                 document.getElementById('walletSwitch').style.display = 'block';
                 document.getElementById('currentWalletName').textContent = walletName;
                 
                 showStatus(`‚úÖ ${walletName} Èí±ÂåÖËøûÊé•ÊàêÂäüÔºÅ`, 'success');
                 
             } catch (error) {
                 console.error('MetaMask ËøûÊé•Â§±Ë¥•:', error);
                 showStatus(`‚ùå MetaMask ËøûÊé•Â§±Ë¥•: ${error.message}`, 'error');
                 
                 // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                 luckyouBtn.disabled = false;
                 metamaskBtn.disabled = false;
                 metamaskBtn.innerHTML = 'ü¶ä ËøûÊé• MetaMask';
                 metamaskBtn.style.background = 'linear-gradient(45deg, #F6851B, #FFA726)';
                 metamaskBtn.onclick = connectMetaMask;
             }
         }

        // Êõ¥Êñ∞Èí±ÂåÖ‰ø°ÊÅØ
        function updateWalletInfo(account, balance, network, walletName) {
            const walletInfo = document.getElementById('walletInfo');
            const contractAddress = document.getElementById('contractAddress');
            const networkInfo = document.getElementById('networkInfo');
            
            walletInfo.style.display = 'block';
            
            // ÂÆâÂÖ®Âú∞ËΩ¨Êç¢‰ΩôÈ¢ùÊòæÁ§∫
            let balanceDisplay = '0 ETH';
            try {
                if (balance && typeof balance === 'string') {
                    if (balance.match(/^0x[0-9a-fA-F]+$/)) {
                        // ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè
                        balanceDisplay = `${web3.utils.fromWei(balance, 'ether')} ETH`;
                    } else if (balance.match(/^\d+$/)) {
                        // ÂçÅËøõÂà∂Ê†ºÂºè
                        balanceDisplay = `${web3.utils.fromWei(balance, 'wei')} ETH`;
                    } else {
                        console.warn('‰ΩôÈ¢ùÊ†ºÂºèÊó†Ê≥ïËØÜÂà´:', balance);
                        balanceDisplay = '0 ETH';
                    }
                } else {
                    console.warn('‰ΩôÈ¢ùÁ±ªÂûãÂºÇÂ∏∏:', typeof balance, balance);
                    balanceDisplay = '0 ETH';
                }
            } catch (error) {
                console.error('‰ΩôÈ¢ùËΩ¨Êç¢Â§±Ë¥•:', error);
                balanceDisplay = '0 ETH';
            }
            
            walletInfo.innerHTML = `
                <p><strong>Èí±ÂåÖÁ±ªÂûã:</strong> ${walletName}</p>
                <p><strong>Ë¥¶Êà∑Âú∞ÂùÄ:</strong> ${account}</p>
                <p><strong>Ë¥¶Êà∑‰ΩôÈ¢ù:</strong> ${balanceDisplay}</p>
                <p><strong>ÁΩëÁªú:</strong> ${network}</p>
            `;
            
            contractAddress.textContent = CONTRACT_ADDRESS;
            networkInfo.textContent = network;
            
            // Êõ¥Êñ∞ÁΩëÁªúÁä∂ÊÄÅÊòæÁ§∫
            const chainId = getChainIdFromNetwork(network);
            updateNetworkStatus(chainId, network, true);
        }
        
        // ‰ªéÁΩëÁªúÂêçÁß∞Ëé∑Âèñ Chain ID
        function getChainIdFromNetwork(network) {
            if (network === 'Hardhat Local Network') {
                return '0x7a69'; // ‰ΩøÁî®ÂΩìÂâç MetaMask ËøûÊé•ÁöÑ Chain ID
            }
            // ËøôÈáåÂèØ‰ª•Ê†πÊçÆÈúÄË¶ÅÊ∑ªÂä†Êõ¥Â§öÁΩëÁªúÊò†Â∞Ñ
            return '0x1'; // ÈªòËÆ§ËøîÂõû‰∏ªÁΩë
        }

        // Ëé∑ÂèñÁΩëÁªúÂêçÁß∞
        function getNetworkName(chainId) {
            const networks = {
                '0x1': 'Ethereum Mainnet',
                '0x3': 'Ropsten Testnet',
                '0x4': 'Rinkeby Testnet',
                '0x5': 'Goerli Testnet',
                '0x2a': 'Kovan Testnet',
                '0x7a69': 'Hardhat Local Network',
                '0x539': 'Hardhat Local Network'
            };
            return networks[chainId] || `Chain ID: ${chainId}`;
        }

        // ÂêØÁî®ÊäΩÂ•ñ
        function enableLottery() {
            const lotteryBtn = document.getElementById('lotteryBtn');
            lotteryBtn.disabled = false;
            lotteryBtn.innerHTML = 'üé≤ ÂºÄÂßãÊäΩÂ•ñ (0.0001 ETH)';
        }
        
        // Ê£ÄÊü•ÂêàÁ∫¶Áä∂ÊÄÅ
        async function checkContractStatus() {
            if (!contract) {
                console.log('ÂêàÁ∫¶Êú™ÂàùÂßãÂåñ');
                return false;
            }
            
            try {
                // Â∞ùËØïË∞ÉÁî®‰∏Ä‰∏™ÁÆÄÂçïÁöÑviewÂáΩÊï∞Êù•Ê£ÄÊü•ÂêàÁ∫¶Áä∂ÊÄÅ
                const price = await contract.methods.lotteryPrice().call();
                console.log('ÂêàÁ∫¶Áä∂ÊÄÅÊ≠£Â∏∏ÔºåÊäΩÂ•ñ‰ª∑Ê†º:', price);
                return true;
            } catch (error) {
                console.error('ÂêàÁ∫¶Áä∂ÊÄÅÊ£ÄÊü•Â§±Ë¥•:', error);
                showStatus('‚ö†Ô∏è ÂêàÁ∫¶Áä∂ÊÄÅÂºÇÂ∏∏ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•', 'error');
                return false;
            }
        }

                 // Êõ¥Êñ∞ÊäΩÂ•ñ‰ø°ÊÅØ
         async function updateLotteryInfo() {
             if (!contract) {
                 console.log('ÂêàÁ∫¶Êú™ÂàùÂßãÂåñÔºåË∑≥ËøáÊõ¥Êñ∞ÊäΩÂ•ñ‰ø°ÊÅØ');
                 return;
             }
             
             try {
                 console.log('ÂºÄÂßãËé∑ÂèñÂÆûÊó∂ÊäΩÂ•ñ‰ø°ÊÅØ...');
                 
                 // ÂàÜÂà´Ëé∑ÂèñÂêÑ‰∏™‰ø°ÊÅØÔºåÈÅøÂÖç‰∏ÄÊ¨°ÊÄßË∞ÉÁî®ÂèØËÉΩÂá∫Èîô
                 let price, poolSize, totalMinted, remaining;
                 
                 try {
                     price = await contract.methods.lotteryPrice().call();
                     console.log('ÂÆûÊó∂ÊäΩÂ•ñ‰ª∑Ê†º:', price);
                     // È™åËØÅËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºè
                     if (price && typeof price === 'object' && price.error) {
                         console.warn('ÊäΩÂ•ñ‰ª∑Ê†ºËøîÂõûÈîôËØØÂØπË±°:', price.error);
                         price = '0';
                     }
                 } catch (priceError) {
                     console.error('Ëé∑ÂèñÊäΩÂ•ñ‰ª∑Ê†ºÂ§±Ë¥•:', priceError);
                     price = '0';
                 }
                 
                 try {
                     poolSize = await contract.methods.getPoolSize().call();
                     console.log('ÂÆûÊó∂Ê±†Â≠êÂ§ßÂ∞è:', poolSize);
                     // È™åËØÅËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºè
                     if (poolSize && typeof poolSize === 'object' && poolSize.error) {
                         console.warn('Ê±†Â≠êÂ§ßÂ∞èËøîÂõûÈîôËØØÂØπË±°:', poolSize.error);
                         poolSize = '0';
                     }
                 } catch (poolError) {
                     console.error('Ëé∑ÂèñÊ±†Â≠êÂ§ßÂ∞èÂ§±Ë¥•:', poolError);
                     poolSize = '0';
                 }
                 
                 try {
                     totalMinted = await contract.methods.totalSupply().call();
                     console.log('ÂÆûÊó∂Â∑≤Èì∏ÈÄ†Êï∞Èáè:', totalMinted);
                     // È™åËØÅËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºè
                     if (totalMinted && typeof totalMinted === 'object' && totalMinted.error) {
                         console.warn('Â∑≤Èì∏ÈÄ†Êï∞ÈáèËøîÂõûÈîôËØØÂØπË±°:', totalMinted.error);
                         totalMinted = '0';
                     }
                 } catch (mintedError) {
                     console.error('Ëé∑ÂèñÂ∑≤Èì∏ÈÄ†Êï∞ÈáèÂ§±Ë¥•:', mintedError);
                     totalMinted = '0';
                 }
                
                 // ËÆ°ÁÆóÂâ©‰ΩôÊï∞Èáè
                 try {
                     const maxSupply = 1000; // ÂêàÁ∫¶‰∏≠ÁöÑMAX_SUPPLY
                     remaining = maxSupply - parseInt(totalMinted || 0);
                     console.log('ÂÆûÊó∂Ââ©‰ΩôÊï∞Èáè:', remaining);
                 } catch (remainingError) {
                     console.error('ËÆ°ÁÆóÂâ©‰ΩôÊï∞ÈáèÂ§±Ë¥•:', remainingError);
                     remaining = '0';
                 }
                 
                 // Êõ¥Êñ∞UI
                 try {
                     console.log('ÂáÜÂ§áÊõ¥Êñ∞UIÔºåÊï∞ÊçÆ:', { price, poolSize, totalMinted, remaining });
                     
                     // Á°Æ‰øùÊï∞ÊçÆÊòØÊúâÊïàÁöÑÂ≠óÁ¨¶‰∏≤ÊàñÊï∞Â≠ó
                     const safePrice = (price && typeof price === 'string' && price.match(/^\d+$/)) ? price : '0';
                     const safePoolSize = (poolSize && typeof poolSize === 'string' && poolSize.match(/^\d+$/)) ? poolSize : '0';
                     const safeTotalMinted = (totalMinted && typeof totalMinted === 'string' && totalMinted.match(/^\d+$/)) ? totalMinted : '0';
                     const safeRemaining = (remaining && typeof remaining === 'number') ? remaining : 0;
                     
                     console.log('ÂÆâÂÖ®Â§ÑÁêÜÂêéÁöÑÊï∞ÊçÆ:', { safePrice, safePoolSize, safeTotalMinted, safeRemaining });
                     
                     const priceInEth = web3.utils.fromWei(safePrice, 'ether');
                     document.getElementById('lotteryPrice').textContent = `${priceInEth} ETH`;
                     document.getElementById('poolSize').textContent = safePoolSize;
                     document.getElementById('totalMinted').textContent = safeTotalMinted;
                     document.getElementById('remainingSupply').textContent = safeRemaining.toString();
                     
                     console.log('ÂÆûÊó∂ÊäΩÂ•ñ‰ø°ÊÅØÊõ¥Êñ∞ÊàêÂäü');
                     showStatus('üîÑ ÊäΩÂ•ñ‰ø°ÊÅØÂ∑≤Êõ¥Êñ∞', 'info');
                     
                 } catch (uiError) {
                     console.error('Êõ¥Êñ∞UIÂ§±Ë¥•:', uiError);
                     console.error('ÈîôËØØËØ¶ÊÉÖ:', uiError.message, uiError.stack);
                 }
                
             } catch (error) {
                 console.error('Ëé∑ÂèñÊäΩÂ•ñ‰ø°ÊÅØÂ§±Ë¥•:', error);
                 showStatus('‚ö†Ô∏è Êó†Ê≥ïËé∑ÂèñÂÆûÊó∂ÊäΩÂ•ñ‰ø°ÊÅØÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•', 'info');
             }
         }

        // ÁúüÂÆûÊäΩÂ•ñ
        async function playLottery() {
            if (!contract || !userAccount) {
                showStatus('‚ùå ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ', 'error');
                return;
            }
            
            // Ê£ÄÊü•ÂêàÁ∫¶Áä∂ÊÄÅ
            const contractStatus = await checkContractStatus();
            if (!contractStatus) {
                showStatus('‚ùå ÂêàÁ∫¶Áä∂ÊÄÅÂºÇÂ∏∏ÔºåÊó†Ê≥ïÊäΩÂ•ñ', 'error');
                return;
            }

            const lotteryBtn = document.getElementById('lotteryBtn');
            const originalText = lotteryBtn.innerHTML;
            
            try {
                // Á¶ÅÁî®ÊåâÈíÆÂπ∂ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                lotteryBtn.disabled = true;
                lotteryBtn.innerHTML = '<span class="spinner"></span> ÊäΩÂ•ñ‰∏≠...';
                
                // Ëé∑ÂèñÊäΩÂ•ñ‰ª∑Ê†º
                const price = await contract.methods.lotteryPrice().call();
                
                                 // Ê£ÄÊü•Áî®Êà∑‰ΩôÈ¢ù - Ê∑ªÂä†ÈîôËØØÂ§ÑÁêÜ
                 try {
                     const userBalanceBN = web3.utils.toBN(userBalance || '0');
                     const priceBN = web3.utils.toBN(price || '0');
                     
                     if (userBalanceBN.lt(priceBN)) {
                         throw new Error('‰ΩôÈ¢ù‰∏çË∂≥ÔºåÊó†Ê≥ïÊîØ‰ªòÊäΩÂ•ñË¥πÁî®');
                     }
                 } catch (balanceError) {
                     console.error('‰ΩôÈ¢ùÊ£ÄÊü•Â§±Ë¥•:', balanceError);
                     throw new Error('‰ΩôÈ¢ùÊ£ÄÊü•Â§±Ë¥•ÔºåËØ∑ÈáçËØï');
                 }
                
                                 // ÊâßË°åÊäΩÂ•ñ‰∫§Êòì - Ê∑ªÂä†ÈáçËØïÊú∫Âà∂
                 let result;
                 let retryCount = 0;
                 const maxRetries = 3;
                 
                 while (retryCount < maxRetries) {
                     try {
                         result = await contract.methods.playLottery().send({
                             from: userAccount,
                             value: price,
                             gas: 300000
                         });
                         break; // ÊàêÂäüÂàôË∑≥Âá∫Âæ™ÁéØ
                     } catch (txError) {
                         retryCount++;
                         console.log(`ÊäΩÂ•ñ‰∫§ÊòìÂ§±Ë¥•ÔºåÁ¨¨ ${retryCount} Ê¨°ÈáçËØï:`, txError);
                         
                         if (retryCount >= maxRetries) {
                             throw new Error(`ÊäΩÂ•ñ‰∫§ÊòìÂ§±Ë¥•ÔºåÂ∑≤ÈáçËØï ${maxRetries} Ê¨°: ${txError.message}`);
                         }
                         
                         // Á≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÂêéÈáçËØï
                         await new Promise(resolve => setTimeout(resolve, 1000 * retryCount));
                     }
                 }
                
                // Êü•ÊâæÊäΩÂ•ñ‰∫ã‰ª∂
                const lotteryEvent = result.events.LotteryWon;
                if (lotteryEvent) {
                    const tokenId = lotteryEvent.returnValues.tokenId;
                    const winner = lotteryEvent.returnValues.winner;
                    const paidAmount = lotteryEvent.returnValues.price;
                    
                    showStatus(`üéâ ÊäΩÂ•ñÊàêÂäüÔºÅËé∑Âæó SnakeCoin #${tokenId}`, 'success');
                    
                                         // ÁîüÊàêNFTÂç°Áâá
                     await generateNFTCard(tokenId);
                     
                     // Êõ¥Êñ∞‰ø°ÊÅØ
                     updateLotteryInfo();
                     
                     // Âà∑Êñ∞Áî®Êà∑ÁöÑNFTÂàóË°®
                     await loadUserNFTs();
                    
                                         // Êõ¥Êñ∞Áî®Êà∑‰ΩôÈ¢ù - Ê∑ªÂä†ÈîôËØØÂ§ÑÁêÜ
                     try {
                         // Áõ¥Êé•‰ΩøÁî®Èí±ÂåÖÊèê‰æõËÄÖËé∑Âèñ‰ΩôÈ¢ùÔºåÈÅøÂÖç Web3.js ÁöÑËá™Âä®ËΩ¨Êç¢
                         const balanceResult = await currentWalletProvider.request({
                             method: 'eth_getBalance',
                             params: [userAccount, 'latest']
                         });
                         
                         // Ê£ÄÊü•ËøîÂõûÁªìÊûúÊòØÂê¶‰∏∫ÊúâÊïàÊï∞Â≠ó
                         if (balanceResult && typeof balanceResult === 'string') {
                             if (balanceResult.match(/^0x[0-9a-fA-F]+$/)) {
                                 // ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè
                                 userBalance = balanceResult;
                                 console.log('Êõ¥Êñ∞ÂêéÁöÑÁî®Êà∑‰ΩôÈ¢ù(ÂçÅÂÖ≠ËøõÂà∂):', userBalance);
                             } else if (balanceResult.match(/^\d+$/)) {
                                 // ÂçÅËøõÂà∂Ê†ºÂºèÔºåËΩ¨Êç¢‰∏∫ÂçÅÂÖ≠ËøõÂà∂
                                 userBalance = '0x' + BigInt(balanceResult).toString(16);
                                 console.log('Êõ¥Êñ∞ÂêéÁöÑÁî®Êà∑‰ΩôÈ¢ù(ÂçÅËøõÂà∂ËΩ¨ÂçÅÂÖ≠ËøõÂà∂):', userBalance);
                             } else {
                                 console.warn('‰ΩôÈ¢ùÊõ¥Êñ∞ËøîÂõûÊ†ºÂºèÂºÇÂ∏∏:', balanceResult);
                                 // ‰øùÊåÅÂéüÊúâ‰ΩôÈ¢ù‰∏çÂèò
                             }
                         } else if (balanceResult && typeof balanceResult === 'object' && balanceResult.error) {
                             // Â§ÑÁêÜÈîôËØØÂØπË±°
                             console.warn('‰ΩôÈ¢ùÊõ¥Êñ∞ËøîÂõûÈîôËØØÂØπË±°:', balanceResult.error);
                             console.warn('RPC Ë∞ÉÁî®Â§±Ë¥•Ôºå‰øùÊåÅÂéüÊúâ‰ΩôÈ¢ù‰∏çÂèò');
                             // ‰øùÊåÅÂéüÊúâ‰ΩôÈ¢ù‰∏çÂèò
                         } else {
                             console.warn('‰ΩôÈ¢ùÊõ¥Êñ∞ËøîÂõûÁ±ªÂûãÂºÇÂ∏∏:', typeof balanceResult, balanceResult);
                             // ‰øùÊåÅÂéüÊúâ‰ΩôÈ¢ù‰∏çÂèò
                         }
                         
                         // ÂÆâÂÖ®Âú∞Ëé∑ÂèñÁΩëÁªú‰ø°ÊÅØ
                         let currentNetworkName;
                         try {
                             if (currentWalletProvider) {
                                 const currentChainId = await currentWalletProvider.request({ method: 'eth_chainId' });
                                 currentNetworkName = getNetworkName(currentChainId);
                             } else {
                                 currentNetworkName = 'Hardhat Local Network';
                             }
                         } catch (networkError) {
                             currentNetworkName = 'Hardhat Local Network';
                         }
                         
                         updateWalletInfo(userAccount, userBalance, currentNetworkName, currentWalletName);
                     } catch (balanceUpdateError) {
                         console.error('Êõ¥Êñ∞‰ΩôÈ¢ùÂ§±Ë¥•:', balanceUpdateError);
                         // ‰∏çÈòªÊ≠¢ÊäΩÂ•ñÊàêÂäüÔºåÂè™ËÆ∞ÂΩïÈîôËØØ
                     }
                    
                } else {
                    throw new Error('ÊäΩÂ•ñ‰∫ã‰ª∂Êú™ÊâæÂà∞');
                }
                
            } catch (error) {
                console.error('ÊäΩÂ•ñÂ§±Ë¥•:', error);
                showStatus(`‚ùå ÊäΩÂ•ñÂ§±Ë¥•: ${error.message}`, 'error');
            } finally {
                // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                lotteryBtn.disabled = false;
                lotteryBtn.innerHTML = originalText;
            }
        }

                 // Âä†ËΩΩÁî®Êà∑Êã•ÊúâÁöÑNFT
         async function loadUserNFTs() {
             if (!contract || !userAccount) return;
             
             try {
                 const myNftGrid = document.getElementById('myNftGrid');
                 
                 // Ê∏ÖÁ©∫Áé∞ÊúâÂÜÖÂÆπ
                 myNftGrid.innerHTML = '';
                 
                 console.log('=== ÂºÄÂßãÂä†ËΩΩÁî®Êà∑NFT ===');
                 console.log('ÂΩìÂâçÈí±ÂåÖÁ±ªÂûã:', currentWalletName);
                 console.log('Áî®Êà∑Âú∞ÂùÄ:', userAccount);
                 console.log('ÂêàÁ∫¶Âú∞ÂùÄ:', CONTRACT_ADDRESS);
                 
                 // Ëé∑ÂèñÊÄª‰æõÂ∫îÈáè
                 try {
                     const totalSupply = await contract.methods.totalSupply().call();
                     console.log('ÊÄª‰æõÂ∫îÈáè:', totalSupply.toString());
                     
                     if (totalSupply == 0) {
                         updateMyNftStatus('üì≠ ÊÇ®ËøòÊ≤°Êúâ‰ªª‰ΩïNFT');
                         return;
                     }
                 } catch (supplyError) {
                     console.error('Ëé∑ÂèñÊÄª‰æõÂ∫îÈáèÂ§±Ë¥•:', supplyError);
                     showStatus('‚ùå Êó†Ê≥ïËé∑ÂèñÊÄª‰æõÂ∫îÈáèÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•', 'error');
                     return;
                 }
                 
                 updateMyNftStatus('üîç Ê≠£Âú®Êü•ÊâæÊÇ®ÁöÑNFT...');
                 console.log('ÂºÄÂßãÊü•ÊâæÁî®Êà∑NFTÔºåÁî®Êà∑Âú∞ÂùÄ:', userAccount);
                 
                 // ÈÅçÂéÜÊâÄÊúâÂèØËÉΩÁöÑtokenIdÔºåÊ£ÄÊü•Áî®Êà∑ÊòØÂê¶Êã•Êúâ
                 let userNFTCount = 0;
                 const maxSupply = 1000; // ÂêàÁ∫¶‰∏≠ÁöÑMAX_SUPPLY
                 const userNFTs = []; // Â≠òÂÇ®ÊâæÂà∞ÁöÑNFT‰ø°ÊÅØ
                 
                 // ÂàÜÊâπÂ§ÑÁêÜÔºåÈÅøÂÖç‰∏ÄÊ¨°ÊÄßÂ§ÑÁêÜÂ§™Â§öËØ∑Ê±Ç
                 const batchSize = 50;
                 let processedCount = 0;
                 
                 for (let tokenId = 0; tokenId < maxSupply; tokenId++) {
                     try {
                         // Ê£ÄÊü•tokenÊòØÂê¶Â≠òÂú®
                         const owner = await contract.methods.ownerOf(tokenId).call();
                         
                         if (processedCount < 10) { // Âè™ËÆ∞ÂΩïÂâç10‰∏™ÁöÑËØ¶ÁªÜ‰ø°ÊÅØ
                             console.log(`Token ${tokenId} ÁöÑÊâÄÊúâËÄÖ:`, owner);
                         }
                         
                         if (owner.toLowerCase() === userAccount.toLowerCase()) {
                             // Áî®Êà∑Êã•ÊúâËøô‰∏™NFTÔºåÂÖàÊî∂ÈõÜ‰ø°ÊÅØÔºå‰∏çÁ´ãÂç≥ÁîüÊàêÂç°Áâá
                             console.log(`‚úÖ ÊâæÂà∞Áî®Êà∑Êã•ÊúâÁöÑNFT: Token ${tokenId}`);
                             userNFTs.push(tokenId);
                             userNFTCount++;
                         }
                         
                         processedCount++;
                         
                         // ÊØèÂ§ÑÁêÜ‰∏ÄÊâπÔºåÊõ¥Êñ∞Áä∂ÊÄÅ
                         if (processedCount % batchSize === 0) {
                             updateMyNftStatus(`üîç Â∑≤Ê£ÄÊü• ${processedCount}/${maxSupply} ‰∏™Token...`);
                             console.log(`Â∑≤Â§ÑÁêÜ ${processedCount}/${maxSupply} ‰∏™TokenÔºåÊâæÂà∞ ${userNFTCount} ‰∏™NFT`);
                         }
                         
                     } catch (error) {
                         // token‰∏çÂ≠òÂú®ÔºåÁªßÁª≠‰∏ã‰∏Ä‰∏™
                         if (processedCount < 10) { // Âè™ËÆ∞ÂΩïÂâç10‰∏™ÈîôËØØ
                             console.log(`Token ${tokenId} ‰∏çÂ≠òÂú®ÊàñÂá∫Èîô:`, error.message);
                         }
                         processedCount++;
                         continue;
                     }
                 }
                 
                 console.log('=== Êü•ÊâæÂÆåÊàê ===');
                 console.log('Áî®Êà∑Êã•ÊúâNFTÊï∞Èáè:', userNFTCount);
                 console.log('ÊâæÂà∞ÁöÑNFT Token IDs:', userNFTs);
                 console.log('ÂΩìÂâçÈí±ÂåÖÁ±ªÂûã:', currentWalletName);
                 
                 if (userNFTCount > 0) {
                     updateMyNftStatus(`‚úÖ ÊâæÂà∞ ${userNFTCount} ‰∏™NFT`);
                     
                     // ÊåâÂÄíÂ∫èÊéíÂàóÔºåÊúÄÊñ∞ÁöÑÊéíÂú®ÂâçÈù¢
                     userNFTs.sort((a, b) => b - a);
                     console.log('ÂÄíÂ∫èÊéíÂàóÂêéÁöÑNFT Token IDs:', userNFTs);
                     
                     // ÊåâÂÄíÂ∫èÁîüÊàêNFTÂç°Áâá
                     for (const tokenId of userNFTs) {
                         await generateUserNFTCard(tokenId);
                     }
                     
                 } else {
                     updateMyNftStatus('üì≠ ÊÇ®ËøòÊ≤°Êúâ‰ªª‰ΩïNFT');
                     console.log('Áî®Êà∑Ê≤°ÊúâÊâæÂà∞‰ªª‰ΩïNFTÔºåÂèØËÉΩÁöÑÂéüÂõ†:');
                     console.log('1. Áî®Êà∑Á°ÆÂÆûÊ≤°ÊúâNFT');
                     console.log('2. ÁΩëÁªú‰∏çÂêåÊ≠•');
                     console.log('3. ÂêàÁ∫¶Ë∞ÉÁî®ÊùÉÈôêÈóÆÈ¢ò');
                     console.log('4. Èí±ÂåÖRPCËäÇÁÇπÈóÆÈ¢ò');
                 }
                 
             } catch (error) {
                 console.error('Âä†ËΩΩÁî®Êà∑NFTÂ§±Ë¥•:', error);
                 console.error('ÈîôËØØËØ¶ÊÉÖ:', error.message, error.stack);
                 showStatus('‚ö†Ô∏è Âä†ËΩΩÁî®Êà∑NFTÂ§±Ë¥•: ' + error.message, 'error');
             }
         }

        // ÁîüÊàêÁî®Êà∑NFTÂç°Áâá
        async function generateUserNFTCard(tokenId) {
            try {
                // Ëé∑ÂèñSVG
                const svg = await contract.methods.generateSnakeSVG(tokenId).call();
                
                // Ëé∑ÂèñTokenURI
                const tokenURI = await contract.methods.tokenURI(tokenId).call();
                
                // Ëß£Á†ÅBase64Ëé∑ÂèñÂÖÉÊï∞ÊçÆ
                const base64Data = tokenURI.replace("data:application/json;base64,", "");
                const jsonData = JSON.parse(atob(base64Data));
                
                // ÂàõÂª∫NFTÂç°Áâá
                const myNftGrid = document.getElementById('myNftGrid');
                const nftCard = document.createElement('div');
                nftCard.className = 'nft-card';
                nftCard.innerHTML = `
                    <h3>${jsonData.name}</h3>
                    <div class="nft-svg">
                        ${svg}
                    </div>
                    <div class="nft-info">
                        <p><strong>Token ID:</strong> ${tokenId}</p>
                        <p><strong>ÊèèËø∞:</strong> ${jsonData.description}</p>
                        <p><strong>ËõáÁ†Å:</strong> ${jsonData.attributes[0].value}</p>
                        <p><strong>È¢úËâ≤‰∏ªÈ¢ò:</strong> <span style="color: ${jsonData.attributes[1].value}">${jsonData.attributes[1].value}</span></p>
                        <p><strong>ÂõæÊ°àÁ±ªÂûã:</strong> ${jsonData.attributes[2].value}</p>
                        <p><strong>Áä∂ÊÄÅ:</strong> <span style="color: #28a745;">‚úÖ Â∑≤Êã•Êúâ</span></p>
                    </div>
                `;
                
                // Ê∑ªÂä†Âà∞Áî®Êà∑NFTÁΩëÊ†º
                myNftGrid.appendChild(nftCard);
                
            } catch (error) {
                console.error('ÁîüÊàêÁî®Êà∑NFTÂç°ÁâáÂ§±Ë¥•:', error);
            }
        }

        // ÁîüÊàêNFTÂç°Áâá
        async function generateNFTCard(tokenId) {
            try {
                // Ëé∑ÂèñSVG
                const svg = await contract.methods.generateSnakeSVG(tokenId).call();
                
                // Ëé∑ÂèñTokenURI
                const tokenURI = await contract.methods.tokenURI(tokenId).call();
                
                // Ëß£Á†ÅBase64Ëé∑ÂèñÂÖÉÊï∞ÊçÆ
                const base64Data = tokenURI.replace("data:application/json;base64,", "");
                const jsonData = JSON.parse(atob(base64Data));
                
                // ÂàõÂª∫NFTÂç°Áâá
                const nftGrid = document.getElementById('nftGrid');
                const nftCard = document.createElement('div');
                nftCard.className = 'nft-card';
                nftCard.innerHTML = `
                    <h3>${jsonData.name}</h3>
                    <div class="nft-svg">
                        ${svg}
                    </div>
                    <div class="nft-info">
                        <p><strong>Token ID:</strong> ${tokenId}</p>
                        <p><strong>ÊèèËø∞:</strong> ${jsonData.description}</p>
                        <p><strong>ËõáÁ†Å:</strong> ${jsonData.attributes[0].value}</p>
                        <p><strong>È¢úËâ≤‰∏ªÈ¢ò:</strong> <span style="color: ${jsonData.attributes[1].value}">${jsonData.attributes[1].value}</span></p>
                        <p><strong>ÂõæÊ°àÁ±ªÂûã:</strong> ${jsonData.attributes[2].value}</p>
                    </div>
                `;
                
                // ÊèíÂÖ•Âà∞ÁΩëÊ†ºÂºÄÂ§¥
                nftGrid.insertBefore(nftCard, nftGrid.firstChild);
                
            } catch (error) {
                console.error('ÁîüÊàêNFTÂç°ÁâáÂ§±Ë¥•:', error);
                showStatus('‚ö†Ô∏è NFTÁîüÊàêÊàêÂäüÔºå‰ΩÜÊòæÁ§∫Â§±Ë¥•', 'info');
            }
        }

        // ÊòæÁ§∫Áä∂ÊÄÅÊ∂àÊÅØ
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusDiv');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 5000);
        }

        // Êõ¥Êñ∞ÊàëÁöÑNFTÁä∂ÊÄÅ
        function updateMyNftStatus(message) {
            const statusElement = document.getElementById('myNftStatus');
            if (statusElement) {
                statusElement.textContent = message;
            }
        }

        // Ê†áÁ≠æÈ°µÂàáÊç¢
        function switchTab(tabName) {
            // ÁßªÈô§ÊâÄÊúâÊ†áÁ≠æÈ°µÁöÑactiveÁ±ª
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabBtns.forEach(btn => btn.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            // ÊøÄÊ¥ªÈÄâ‰∏≠ÁöÑÊ†áÁ≠æÈ°µ
            if (tabName === 'latest') {
                document.getElementById('latestTab').classList.add('active');
                document.getElementById('latestTabContent').classList.add('active');
            } else if (tabName === 'my') {
                document.getElementById('myTab').classList.add('active');
                document.getElementById('myTabContent').classList.add('active');
                
                // Â¶ÇÊûúÂàáÊç¢Âà∞"ÊàëÁöÑNFT"Ê†áÁ≠æÔºåËá™Âä®Âä†ËΩΩÁî®Êà∑NFT
                if (contract && userAccount) {
                    loadUserNFTs();
                }
            }
        }

                 // Ê£ÄÊü•Èí±ÂåÖÁä∂ÊÄÅ
         function checkWallet() {
             const luckyouBtn = document.getElementById('luckyouBtn');
             const metamaskBtn = document.getElementById('metamaskBtn');
             
             // Ê£ÄÊµãÂèØÁî®ÁöÑÈí±ÂåÖ
             let luckyouAvailable = false;
             let metamaskAvailable = false;
             
             // Ê£ÄÊµã LuckYou Wallet
             if (typeof window.luckYou !== 'undefined' || (window.luckyouWallet && window.luckyouWallet.isLuckYouWallet)) {
                 luckyouAvailable = true;
                 console.log('‚úÖ LuckYou Èí±ÂåÖÂèØÁî®');
             } else {
                 console.log('‚ùå LuckYou Èí±ÂåÖ‰∏çÂèØÁî®');
             }
             
             // Ê£ÄÊµã MetaMask
             if (typeof window.ethereum !== 'undefined' && window.ethereum.isMetaMask) {
                 metamaskAvailable = true;
                 console.log('‚úÖ MetaMask Èí±ÂåÖÂèØÁî®');
             } else {
                 console.log('‚ùå MetaMask Èí±ÂåÖ‰∏çÂèØÁî®');
             }
             
             // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
             if (luckyouAvailable) {
                 luckyouBtn.disabled = false;
                 luckyouBtn.style.background = 'linear-gradient(45deg, #FF6B6B, #FF8E8E)';
                 showStatus('‚úÖ LuckYou Èí±ÂåÖÂ∑≤Â∞±Áª™ÔºÅ', 'success');
             } else {
                 luckyouBtn.disabled = true;
                 luckyouBtn.style.background = '#6c757d';
                 luckyouBtn.innerHTML = '‚ùå ËØ∑ÂÆâË£Ö LuckYou Èí±ÂåÖ';
             }
             
             if (metamaskAvailable) {
                 metamaskBtn.disabled = false;
                 metamaskBtn.style.background = 'linear-gradient(45deg, #F6851B, #FFA726)';
                 showStatus('‚úÖ MetaMask Èí±ÂåÖÂ∑≤Â∞±Áª™ÔºÅ', 'success');
             } else {
                 metamaskBtn.disabled = true;
                 metamaskBtn.style.background = '#6c757d';
                 metamaskBtn.innerHTML = '‚ùå ËØ∑ÂÆâË£Ö MetaMask';
             }
             
             // Â¶ÇÊûú‰∏§‰∏™Èí±ÂåÖÈÉΩ‰∏çÂèØÁî®
             if (!luckyouAvailable && !metamaskAvailable) {
                 showStatus('‚ùå Êú™Ê£ÄÊµãÂà∞‰ªª‰ΩïÈí±ÂåÖÔºåËØ∑ÂÆâË£Ö LuckYou Èí±ÂåÖÊàñ MetaMask Êâ©Â±ï', 'error');
             } else if (luckyouAvailable && metamaskAvailable) {
                 showStatus('‚úÖ Ê£ÄÊµãÂà∞‰∏§‰∏™Èí±ÂåÖÔºåÊÇ®ÂèØ‰ª•ÈÄâÊã©‰ªªÊÑè‰∏Ä‰∏™ËøûÊé•ÔºÅ', 'success');
             }
         }

                 // È¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØÔºà‰ΩøÁî®ÈªòËÆ§ Hardhat ÁΩëÁªúÔºâ
         async function preloadContractInfo() {
             try {
                 console.log('ÂºÄÂßãÈ¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØ...');
                 
                 // ÂàõÂª∫‰∏¥Êó∂ÁöÑ Web3 ÂÆû‰æãËøûÊé•Âà∞ Hardhat ÁΩëÁªú
                 const tempWeb3 = new Web3('http://127.0.0.1:8545');
                 const tempContract = new tempWeb3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                 
                 // Â∞ùËØïËé∑ÂèñÂêàÁ∫¶‰ø°ÊÅØ
                 let price, poolSize, totalMinted, remaining;
                 
                 try {
                     price = await tempContract.methods.lotteryPrice().call();
                     console.log('È¢ÑÂä†ËΩΩÊäΩÂ•ñ‰ª∑Ê†º:', price);
                 } catch (error) {
                     console.warn('È¢ÑÂä†ËΩΩÊäΩÂ•ñ‰ª∑Ê†ºÂ§±Ë¥•:', error.message);
                     price = '100000000000000'; // ÈªòËÆ§ 0.0001 ETH (wei)
                 }
                 
                 try {
                     poolSize = await tempContract.methods.getPoolSize().call();
                     console.log('È¢ÑÂä†ËΩΩÊ±†Â≠êÂ§ßÂ∞è:', poolSize);
                 } catch (error) {
                     console.warn('È¢ÑÂä†ËΩΩÊ±†Â≠êÂ§ßÂ∞èÂ§±Ë¥•:', error.message);
                     poolSize = '100'; // ÈªòËÆ§ÂÄº
                 }
                 
                 try {
                     totalMinted = await tempContract.methods.totalSupply().call();
                     console.log('È¢ÑÂä†ËΩΩÂ∑≤Èì∏ÈÄ†Êï∞Èáè:', totalMinted);
                 } catch (error) {
                     console.warn('È¢ÑÂä†ËΩΩÂ∑≤Èì∏ÈÄ†Êï∞ÈáèÂ§±Ë¥•:', error.message);
                     totalMinted = '0'; // ÈªòËÆ§ÂÄº
                 }
                 
                 // ËÆ°ÁÆóÂâ©‰ΩôÊï∞Èáè
                 try {
                     const maxSupply = 1000; // ÂêàÁ∫¶‰∏≠ÁöÑMAX_SUPPLY
                     remaining = maxSupply - parseInt(totalMinted || 0);
                     console.log('È¢ÑÂä†ËΩΩÂâ©‰ΩôÊï∞Èáè:', remaining);
                 } catch (error) {
                     console.warn('È¢ÑÂä†ËΩΩÂâ©‰ΩôÊï∞ÈáèËÆ°ÁÆóÂ§±Ë¥•:', error.message);
                     remaining = 1000; // ÈªòËÆ§ÂÄº
                 }
                 
                 // Êõ¥Êñ∞UIÊòæÁ§∫È¢ÑÂä†ËΩΩÁöÑ‰ø°ÊÅØ
                 try {
                     const priceInEth = tempWeb3.utils.fromWei(price || '100000000000000', 'ether');
                     document.getElementById('lotteryPrice').textContent = `${priceInEth} ETH`;
                     document.getElementById('poolSize').textContent = poolSize || '100';
                     document.getElementById('totalMinted').textContent = totalMinted || '0';
                     document.getElementById('remainingSupply').textContent = (remaining || 1000).toString();
                     
                     console.log('ÂêàÁ∫¶‰ø°ÊÅØÈ¢ÑÂä†ËΩΩÊàêÂäü');
                     showStatus('‚úÖ ÂêàÁ∫¶‰ø°ÊÅØÂ∑≤Âä†ËΩΩÔºåËØ∑ËøûÊé•Èí±ÂåÖÂºÄÂßãÊäΩÂ•ñÔºÅ', 'success');
                     
                 } catch (uiError) {
                     console.error('È¢ÑÂä†ËΩΩUIÊõ¥Êñ∞Â§±Ë¥•:', uiError);
                 }
                 
             } catch (error) {
                 console.error('È¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØÂ§±Ë¥•:', error);
                 showStatus('‚ö†Ô∏è Êó†Ê≥ïÈ¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØÔºåËØ∑Á°Æ‰øù Hardhat ËäÇÁÇπÊ≠£Âú®ËøêË°å', 'info');
             }
         }
         
         // Âà∑Êñ∞ÂêàÁ∫¶‰ø°ÊÅØÔºàÊ†πÊçÆÂΩìÂâçÁä∂ÊÄÅÈÄâÊã©ÂêàÈÄÇÁöÑÊñπÊ≥ïÔºâ
         async function refreshContractInfo() {
             if (contract && web3) {
                 // Â¶ÇÊûúÂ∑≤ËøûÊé•Èí±ÂåÖÔºå‰ΩøÁî®ÂÆûÊó∂Êõ¥Êñ∞
                 console.log('‰ΩøÁî®Â∑≤ËøûÊé•ÁöÑÈí±ÂåÖÂà∑Êñ∞ÂêàÁ∫¶‰ø°ÊÅØ');
                 await updateLotteryInfo();
             } else {
                 // Â¶ÇÊûúÊú™ËøûÊé•Èí±ÂåÖÔºå‰ΩøÁî®È¢ÑÂä†ËΩΩ
                 console.log('‰ΩøÁî®È¢ÑÂä†ËΩΩÊñπÂºèÂà∑Êñ∞ÂêàÁ∫¶‰ø°ÊÅØ');
                 await preloadContractInfo();
             }
         }
         
         // ÁΩëÁªúËØäÊñ≠ÂáΩÊï∞
         async function diagnoseNetwork() {
             if (!currentWalletProvider) {
                 showStatus('‚ùå ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ', 'error');
                 return;
             }
             
             try {
                 showStatus('üîç Ê≠£Âú®ËØäÊñ≠ÁΩëÁªú...', 'info');
                 console.log('ÂºÄÂßãÁΩëÁªúËØäÊñ≠...');
                 
                 // Ëé∑ÂèñÁΩëÁªú‰ø°ÊÅØ
                 const chainId = await currentWalletProvider.request({ method: 'eth_chainId' });
                 const networkName = getNetworkName(chainId);
                 console.log('ÂΩìÂâçÁΩëÁªú Chain ID:', chainId);
                 console.log('ÂΩìÂâçÁΩëÁªúÂêçÁß∞:', networkName);
                 
                 // Ê£ÄÊü•ÁΩëÁªúÊòØÂê¶ÂåπÈÖç
                 if (chainId !== '0x539' && chainId !== '0x31337' && chainId !== '0x7a69') {
                     showStatus('‚ö†Ô∏è ÂΩìÂâçÁΩëÁªú‰∏çÂåπÈÖçÔºåÂêàÁ∫¶Âú∞ÂùÄ‰ªÖÈÄÇÁî®‰∫éÊú¨Âú∞ Hardhat ÁΩëÁªú', 'warning');
                     console.warn('ÁΩëÁªú‰∏çÂåπÈÖçÔºåË∑≥ËøáÂêàÁ∫¶ÊµãËØï');
                     return;
                 }
                 
                 // Ëé∑ÂèñÊúÄÊñ∞Âå∫Âùó
                 const latestBlock = await currentWalletProvider.request({
                     method: 'eth_getBlockByNumber',
                     params: ['latest', false]
                 });
                 console.log('ÊúÄÊñ∞Âå∫ÂùóÂè∑:', latestBlock.number);
                 console.log('ÊúÄÊñ∞Âå∫ÂùóÊó∂Èó¥Êà≥:', latestBlock.timestamp);
                 
                 // ÊµãËØïÂêàÁ∫¶Ë∞ÉÁî®
                 if (contract) {
                     try {
                         console.log('ÊµãËØïÂêàÁ∫¶Ë∞ÉÁî®...');
                         
                         // ÂÖàÊ£ÄÊü•ÂêàÁ∫¶ÊòØÂê¶Â≠òÂú®
                         const code = await web3.eth.getCode(CONTRACT_ADDRESS);
                         if (code === '0x' || code === '0x0') {
                             throw new Error('ÂêàÁ∫¶Âú∞ÂùÄ‰∏äÊ≤°Êúâ‰ª£Á†ÅÔºåËØ∑Ê£ÄÊü•ÂêàÁ∫¶ÊòØÂê¶Â∑≤ÈÉ®ÁΩ≤');
                         }
                         
                         const price = await contract.methods.lotteryPrice().call();
                         console.log('ÂêàÁ∫¶Ë∞ÉÁî®ÊàêÂäüÔºåÊäΩÂ•ñ‰ª∑Ê†º:', price);
                         
                         const totalSupply = await contract.methods.totalSupply().call();
                         console.log('ÂêàÁ∫¶Ë∞ÉÁî®ÊàêÂäüÔºåÊÄª‰æõÂ∫îÈáè:', totalSupply);
                         
                         showStatus('‚úÖ ÁΩëÁªúËØäÊñ≠ÂÆåÊàêÔºåÂêàÁ∫¶Ë∞ÉÁî®Ê≠£Â∏∏', 'success');
                     } catch (contractError) {
                         console.error('ÂêàÁ∫¶Ë∞ÉÁî®Â§±Ë¥•:', contractError);
                         
                         // Ê£ÄÊü•ÊòØÂê¶ÊòØÁΩëÁªú‰∏çÂåπÈÖçÁöÑÈóÆÈ¢ò
                         if (chainId !== '0x539' && chainId !== '0x31337' && chainId !== '0x7a69') {
                             showStatus('‚ùå ÁΩëÁªúËØäÊñ≠ÂÆåÊàêÔºåÂΩìÂâçÁΩëÁªú‰∏çÊîØÊåÅÊ≠§ÂêàÁ∫¶', 'error');
                         } else {
                             showStatus('‚ùå ÁΩëÁªúËØäÊñ≠ÂÆåÊàêÔºåÂêàÁ∫¶Ë∞ÉÁî®Â§±Ë¥•', 'error');
                         }
                     }
                 } else {
                     console.log('ÂêàÁ∫¶Êú™ÂàùÂßãÂåñÔºåË∑≥ËøáÂêàÁ∫¶ÊµãËØï');
                     showStatus('‚ö†Ô∏è ÁΩëÁªúËØäÊñ≠ÂÆåÊàêÔºå‰ΩÜÂêàÁ∫¶Êú™ÂàùÂßãÂåñ', 'info');
                 }
                 
             } catch (error) {
                 console.error('ÁΩëÁªúËØäÊñ≠Â§±Ë¥•:', error);
                 showStatus(`‚ùå ÁΩëÁªúËØäÊñ≠Â§±Ë¥•: ${error.message}`, 'error');
             }
         }
         
         // È°µÈù¢Âä†ËΩΩÊó∂Ê£ÄÊü•Èí±ÂåÖÂíåÈ¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØ
         window.onload = function() {
             console.log('È°µÈù¢Âä†ËΩΩÂÆåÊàêÔºåÊ£ÄÊü•Èí±ÂåÖÁä∂ÊÄÅÂíåÈ¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØ...');
             
             // Ê£ÄÊü• Web3 ÁâàÊú¨
             if (typeof Web3 !== 'undefined') {
                 console.log('Web3 ÁâàÊú¨:', Web3.version);
                 console.log('Web3 Â∫ìÂ∑≤Âä†ËΩΩ');
             } else {
                 console.error('Web3 Â∫ìÊú™Âä†ËΩΩÔºÅ');
                 showStatus('‚ùå Web3 Â∫ìÂä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•', 'error');
                 return;
             }
             
             console.log('window.luckYou:', typeof window.luckYou !== 'undefined' ? 'Â∑≤ÂÆö‰πâ' : 'Êú™ÂÆö‰πâ');
             console.log('window.luckyouWallet:', typeof window.luckyouWallet !== 'undefined' ? 'Â∑≤ÂÆö‰πâ' : 'Êú™ÂÆö‰πâ');
             if (window.luckyouWallet) {
                 console.log('window.luckyouWallet.isLuckYouWallet:', window.luckyouWallet.isLuckYouWallet);
             }
             console.log('window.ethereum:', typeof window.ethereum !== 'undefined' ? 'Â∑≤ÂÆö‰πâ' : 'Êú™ÂÆö‰πâ');
             if (typeof window.ethereum !== 'undefined') {
                 console.log('window.ethereum.isMetaMask:', window.ethereum.isMetaMask);
             }
             
             // È¢ÑÂä†ËΩΩÂêàÁ∫¶‰ø°ÊÅØÔºà‰ΩøÁî®ÈªòËÆ§ Hardhat ÁΩëÁªúÔºâ
             preloadContractInfo();
             
             // Âª∂ËøüÊ£ÄÊü•Èí±ÂåÖÔºåÁ°Æ‰øùÊâ©Â±ïÂä†ËΩΩÂÆåÊàê
             setTimeout(() => {
                 checkWallet();
             }, 1000);
         };

        // ÁõëÂê¨Ë¥¶Êà∑ÂèòÂåñ
        function setupWalletListeners() {
            // Ê£ÄÊµãÂèØÁî®ÁöÑÈí±ÂåÖ
            const availableWallets = [];
            
            // Ê£ÄÊµã LuckYou Wallet (‰∏ªË¶ÅÂØπË±°)
            if (typeof window.luckYou !== 'undefined') {
                availableWallets.push({
                    id: 'luckyou',
                    name: 'LuckYou Wallet',
                    provider: window.luckYou
                });
            }
            
            // Ê£ÄÊµã LuckYou Wallet (Êõø‰ª£ÂØπË±°)
            if (window.luckyouWallet && window.luckyouWallet.isLuckYouWallet) {
                availableWallets.push({
                    id: 'luckyou-alt',
                    name: 'LuckYou Wallet',
                    provider: window.luckyouWallet
                });
            }
            
            // Ê£ÄÊµã MetaMask
            if (typeof window.ethereum !== 'undefined' && window.ethereum.isMetaMask) {
                availableWallets.push({
                    id: 'metamask',
                    name: 'MetaMask',
                    provider: window.ethereum
                });
            }
            
            // Ê£ÄÊµãÂÖ∂‰ªñÂÖºÂÆπÈí±ÂåÖ
            if (typeof window.ethereum !== 'undefined' && !window.ethereum.isMetaMask) {
                availableWallets.push({
                    id: 'compatible',
                    name: 'ÂÖºÂÆπÈí±ÂåÖ',
                    provider: window.ethereum
                });
            }
            
            // ‰ºòÂÖà‰ΩøÁî® LuckYou Èí±ÂåÖ
            const preferredWallet = availableWallets.find(w => w.id.includes('luckyou')) || availableWallets[0];
            
            if (preferredWallet) {
                const walletProvider = preferredWallet.provider;
                console.log(`ËÆæÁΩÆ ${preferredWallet.name} ÁõëÂê¨Âô®`);
                
                try {
                    walletProvider.on('accountsChanged', function (accounts) {
                        console.log('Ë¥¶Êà∑ÂèòÂåñ:', accounts);
                        if (accounts.length === 0) {
                            // Áî®Êà∑Êñ≠ÂºÄËøûÊé•
                            location.reload();
                        } else {
                            // Ë¥¶Êà∑ÂàáÊç¢
                            userAccount = accounts[0];
                            location.reload();
                        }
                    });

                    walletProvider.on('chainChanged', function (chainId) {
                        console.log('ÁΩëÁªúÂèòÂåñ:', chainId);
                        // ÁΩëÁªúÂàáÊç¢
                        location.reload();
                    });
                } catch (error) {
                    console.log('ËÆæÁΩÆÈí±ÂåÖÁõëÂê¨Âô®Â§±Ë¥•:', error);
                }
            }
        }

                 // ÂàáÊç¢Èí±ÂåÖ
         async function switchWallet() {
             try {
                 showStatus('üîÑ Ê≠£Âú®ÂàáÊç¢Èí±ÂåÖ...', 'info');
                 
                 // Êñ≠ÂºÄÂΩìÂâçÈí±ÂåÖ
                 disconnectWallet();
                 
                 // Á≠âÂæÖ‰∏Ä‰∏ãÂÜçÈáçÊñ∞Ê£ÄÊµã
                 await new Promise(resolve => setTimeout(resolve, 500));
                 
                 // ÈáçÊñ∞Ê£ÄÊµãÈí±ÂåÖ
                 checkWallet();
                 
                 showStatus('‚úÖ Èí±ÂåÖÂàáÊç¢ÂÆåÊàêÔºåËØ∑ÈáçÊñ∞ËøûÊé•', 'success');
                 
             } catch (error) {
                 console.error('ÂàáÊç¢Èí±ÂåÖÂ§±Ë¥•:', error);
                 showStatus(`‚ùå ÂàáÊç¢Èí±ÂåÖÂ§±Ë¥•: ${error.message}`, 'error');
             }
         }
         
         // ËÆæÁΩÆÈí±ÂåÖÁõëÂê¨Âô®
         setupWalletListeners();

        // Êõ¥Êñ∞ÁΩëÁªúÁä∂ÊÄÅÊòæÁ§∫
        function updateNetworkStatus(chainId, networkName, isConnected = false) {
            const networkStatus = document.getElementById('networkStatus');
            const networkStatusText = document.getElementById('networkStatusText');
            const networkSwitchTip = document.getElementById('networkSwitchTip');
            
            if (!isConnected) {
                networkStatus.style.display = 'none';
                return;
            }
            
            networkStatus.style.display = 'block';
            
            // Ê£ÄÊü•ÁΩëÁªúÊòØÂê¶ÂåπÈÖç
            if (chainId === '0x539' || chainId === '0x31337' || chainId === '0x7a69') {
                networkStatus.className = 'network-status success';
                networkStatusText.textContent = '‚úÖ ÁΩëÁªúÂåπÈÖç - ÂèØ‰ª•Ê≠£Â∏∏‰ΩøÁî®';
                networkSwitchTip.textContent = '';
            } else {
                networkStatus.className = 'network-status error';
                networkStatusText.textContent = '‚ùå ÁΩëÁªú‰∏çÂåπÈÖç - Êó†Ê≥ï‰ΩøÁî®ÂêàÁ∫¶';
                networkSwitchTip.textContent = 'ËØ∑ÂàáÊç¢Âà∞Êú¨Âú∞ Hardhat ÁΩëÁªú (Chain ID: 31337 Êàñ 1337)';
            }
        }
    </script>

    <!-- Web3.js Â∫ì -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
</body>
</html>

